!function(e){"use strict";var t={},r={},n="HeartBeat";t.start=function(e){r.url=e.url,r.methods="undefined"!=typeof e.methods?e.methods:["log","info","warn","error","assert","dir","clear","profile","profileEnd"],r.logConsole="undefined"!=typeof e.logConsole?e.logConsole:!0,r.logError="undefined"!=typeof e.logError?e.logError:!0,r.callback="undefined"!=typeof e.callback?e.callback:function(){},r.logConsole&&this.initConsole(),r.logError&&this.initErrorlog()},t.initErrorlog=function(){e.onerror=function(e,t,r,o,i){if(e!==n){var l={message:e,url:t,line:r,col:o};this.sendMessage(l,"error")}}.bind(this)},t.sendMessage=function(t,n){if(r.callback(t,n),r.url){var i=l(),a=JSON.stringify({id:i,timestamp:(new Date).getTime(),data:t,event:n,useragent:e.navigator.userAgent});o(r.url,"POST",a)}},t.initConsole=function(){var e=/at (.*)\:([0-9]{1,})\:([0-9]{1,})/;r.methods.forEach(function(t){var r=console[t];console[t]=function(n){var o=(new Error).stack.split(/\n/);0===o[0].indexOf("Error")&&(o=o.slice(1));var i=e.exec(o[1].trim()),l={message:n,url:i[1],line:i[2],col:i[3]};this.sendMessage(l,"console."+t),r.apply(console,arguments)}.bind(this)}.bind(this))};var o=function(e,t,r){var n=function(n,o){var i=new XMLHttpRequest;"withCredentials"in i?i.open(t,e,!0):"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open(t,e)):o("CORS is not supported"),i.onload=function(){n(i.responseText)},i.onerror=function(){o("XMLHttpRequest error")},setTimeout(function(){i.send(r)},0)};return new Promise(n)},i=function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++)t=31*t+e.charCodeAt(r),t&=t;return t},l=function(){var t=a(e.navigator)+a(e.screen)+a(e.history);return i(t)},a=function(e,t,r,n){if(t=t||1,r=r||"",n=n||{},3>t)for(var o in e)if(void 0!==e[o])switch(r+=o,typeof e[o]){case"object":r+=a(e[o],++t,"",n);break;case"number":case"string":case"boolean":r+=e[o].toString()}return r};"function"==typeof define&&define.amd?define(["exports"],t):"object"==typeof module&&module.exports?module.exports=t:e.heartbeat=t,"undefined"==typeof Promise&&!function(){function t(e){function r(e,t){o.state="pending",o[e].length?setTimeout(function(){r(e,o.value=o[e].shift().call(n,t))},0):o.state=e}var n=this,o=n.then=function(){return t.prototype.then.apply(n,arguments)};return o.fulfilled=[],o.rejected=[],o.fulfill=function(e){r("fulfilled",e)},o.reject=function(e){r("rejected",e)},e.call(n,o.fulfill,o.reject),n}t.prototype={constructor:t,then:function(e,t){return e&&this.then.fulfilled.push(e),t&&this.then.rejected.push(t),"fulfilled"===this.then.state&&this.then.fulfill(this.then.value),this},"catch":function(e){return e&&this.then.rejected.push(e),this}},t.all=function(){function e(e,t,r){e.then(function o(r){return e.then.fulfilled.length>1?e.then(o):--n||t(r),r},function(e){r(e)})}var r=Array.prototype.slice.call(arguments),n=r.length;return new t(function(t,n){for(;r.length;)e(r.shift(),t,n)})},e.Promise=t}(),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,r=Array.prototype.slice.call(arguments,1),n=function(){},o=function(){return t.apply(this instanceof n&&e?this:e,r.concat(Array.prototype.slice.call(arguments,0)))};return n.prototype=o.prototype=t.prototype,o}),Array.prototype.forEach||(Array.prototype.forEach=function(t,r){for(var n=this,o=0,i=n.length;i>o;++o)t.call(r||e,n[o],o,n)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=this,r=0,n=t.length;n>r;++r)if(t[r]===e)return r;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),"undefined"==typeof e.JSON&&!function(){function e(e){this.line=1,this.col=1,this._tokLen=0,this._str=e}function t(e){this.lex=e}function r(e,t,r){return"undefined"==typeof r?void delete e[t]:void(e[t]=r)}function n(e,t,o){var a,u,s=e[t];if("Array"===i.call(s).slice(8,-1))for(a=0,u=s.length;u>a;a++)r(s,a,n(s,a,o));else if("object"==typeof s)for(a in s)l.call(s,a)&&r(s,a,n(s,a,o));return o.call(e,t,s)}function o(e,t){return e=String(e),e.length>=t?e:new Array(t-e.length+1).join("0")+e}var i=Object.prototype.toString,l=Object.prototype.hasOwnProperty,a="{",u="}",s=":",c="[",f="]",h=",",g={PUNCTUATOR:1,STRING:2,NUMBER:3,BOOLEAN:4,NULL:5},p={"{":1,"}":1,"[":1,"]":1,",":1,":":1,'"':2,t:4,f:4,n:5},d={b:"\b",f:"\f",n:"\n",r:"\r",t:"	",'"':'"',"\\":"\\","/":"/"},y=/^(?:[{}:,\[\]]|true|false|null|"(?:[^"\\\u0000-\u001F]|\\["\\\/bfnrt]|\\u[0-9A-F]{4})*"|-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)/,v=/^[\t ]+/,m=/^\r?\n/;e.prototype={getNextToken:function(){var e,t,r=this._str;if(this.col+=this._tokLen,!r.length)return"END";if(e=y.exec(r))t=p[e[0].charAt(0)]||g.NUMBER;else{if(e=v.exec(r))return this._tokLen=e[0].length,this._str=r.slice(this._tokLen),this.getNextToken();if(e=m.exec(r))return this._tokLen=0,this._str=r.slice(e[0].length),this.line++,this.col=1,this.getNextToken();this.error("Invalid token")}return this._tokLen=e[0].length,this._str=r.slice(this._tokLen),{type:t,value:e[0]}},error:function(e,t,r){var n=new SyntaxError(e);throw n.line=t||this.line,n.col=r||this.col,n}},t.prototype={parse:function(){var e=this.lex,t=this.getValue();return"END"!==e.getNextToken()&&e.error("Illegal token"),t},getObject:function(){for(var e,t,r,n,o,i={},l=this.lex,a=!1;;){if(e=l.getNextToken(),t=e.value,t===u)return i;a?t===h?(n=l.line,o=l.col-1,e=l.getNextToken(),t=e.value,t===u&&l.error("Invalid trailing comma",n,o)):l.error("Illegal token where expect comma or right curly bracket"):t===h&&l.error("Invalid leading comma"),e.type!=g.STRING&&l.error("Illegal token where expect string property name"),r=this.getString(t),e=l.getNextToken(),t=e.value,t!=s&&l.error("Illegal token where expect colon"),i[r]=this.getValue(),a=!0}},getArray:function(){for(var e,t,r,n,o=[],i=this.lex,l=!1;;){if(e=i.getNextToken(),t=e.value,t===f)return o;l?t===h?(r=i.line,n=i.col-1,e=i.getNextToken(),t=e.value,t===f&&i.error("Invalid trailing comma",r,n)):i.error("Illegal token where expect comma or right square bracket"):t===h&&i.error("Invalid leading comma"),o.push(this.getValue(e)),l=!0}},getString:function(e){return e.slice(1,-1).replace(/\\u?([0-9A-F]{4}|["\\\/bfnrt])/g,function(e,t){return d[t]||String.fromCharCode(parseInt(t,16))})},getValue:function(e){var t=this.lex,r=e||t.getNextToken(),n=r.value;switch(r.type){case g.PUNCTUATOR:if(n===a)return this.getObject();if(n===c)return this.getArray();t.error("Illegal punctoator");break;case g.STRING:return this.getString(n);case g.NUMBER:return Number(n);case g.BOOLEAN:return"true"===n;case g.NULL:return null;default:t.error("Invalid value")}}},Window.prototype.JSON={parse:function(r,o){var i=new t(new e(r)).parse();return"function"==typeof o?n({"":i},"",o):i},stringify:function(){var e,t,r,n,a,u,s=arguments[0],c="function"==typeof arguments[1]?arguments[1]:null,f=arguments[2]||"",h=f?" ":"",g=f?"\n":"",p=i.call(s).slice(8,-1);if(null===s||"Boolean"===p||"Number"===p)return s;if("Array"===p){for(e=[],a=s.length,n=0,u;a>n;++n)u=c?c(n,s[n]):s[n],u=this.stringify(u,c,f),(void 0===u||null===u)&&(u="null"),e.push(u);return"["+g+e.join(","+g).replace(/^/gm,f)+g+"]"}if("Date"===p)return'"'+s.getUTCFullYear()+"-"+o(s.getUTCMonth()+1,2)+"-"+o(s.getUTCDate(),2)+"T"+o(s.getUTCHours(),2)+":"+o(s.getUTCMinutes(),2)+":"+o(s.getUTCSeconds(),2)+"."+o(s.getUTCMilliseconds(),3)+'Z"';if("String"===p)return'"'+s.replace(/"/g,'\\"')+'"';if("object"==typeof s){e=[],r=!1;for(t in s)l.call(s,t)&&(u=c?c(t,s[t]):s[t],u=this.stringify(u,c,f),void 0!==u&&(r=!0,e.push('"'+t+'":'+h+u)));return r?"{"+g+e.join(","+g).replace(/^/gm,f)+g+"}":"{}"}}}}(),Array.prototype.filter||(Array.prototype.filter=function(t,r){for(var n,o=this,i=[],l=0,a=o.length;a>l;++l)n=o[l],t.call(r||e,n,l,o)&&i.push(n);return i})}(window);
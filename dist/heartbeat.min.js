!function(e){"use strict";var t={},n={},r="HeartBeat";t.start=function(e){n.url=e.url,n.methods="undefined"!=typeof e.methods?e.methods:["log","info","warn","error","assert","dir","clear","profile","profileEnd"],n.logConsole="undefined"!=typeof e.logConsole?e.logConsole:!0,n.logError="undefined"!=typeof e.logError?e.logError:!0,n.callback="undefined"!=typeof e.callback?e.callback:function(){},n.logConsole&&this.initConsole(),n.logError&&this.initErrorlog()},t.initErrorlog=function(){e.onerror=function(e,t,n,o,i){if(e!==r){var l={message:e,url:t,line:n,col:o};this.sendMessage(l,"error")}}.bind(this)},t.sendMessage=function(t,r){if(n.callback(t,r),n.url){var i=l(),a=JSON.stringify({id:i,timestamp:(new Date).getTime(),data:t,event:r,useragent:e.navigator.userAgent});o(n.url,"POST",a)}},t.initConsole=function(){var e=/\/\/(.*)\:([0-9]{1,})\:([0-9]{1,})/;n.methods.forEach(function(t){var n=console[t];console[t]=function(r){for(var o,i=(new Error).stack.split(/\n/),l=i.length-1;l>=0;l--){var a=e.exec(i[l]);for(var s in a)if(a[s].length>2){o={message:r,url:a[1],line:a[2],col:a[3]};break}if(o)break}o||(o={message:r}),this.sendMessage(o,"console."+t),n.apply(console,arguments)}.bind(this)}.bind(this))};var o=function(e,t,n){var r=function(r,o){var i=new XMLHttpRequest;"withCredentials"in i?i.open(t,e,!0):"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open(t,e)):o("CORS is not supported"),i.onload=function(){r(i.responseText)},i.onerror=function(){o("XMLHttpRequest error")},i.setRequestHeader&&i.setRequestHeader("Content-type","application/json"),setTimeout(function(){i.send(n)},0)};return new Promise(r)},i=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=31*t+e.charCodeAt(n),t&=t;return t},l=function(){var t=a(e.navigator)+a(e.screen)+a(e.history);return i(t)},a=function(e,t,n,r){if(t=t||1,n=n||"",r=r||{},3>t)for(var o in e)if(void 0!==e[o])switch(n+=o,typeof e[o]){case"object":n+=a(e[o],++t,"",r);break;case"number":case"string":case"boolean":n+=e[o].toString()}return n};"function"==typeof define&&define.amd?define(["exports"],t):"object"==typeof module&&module.exports?module.exports=t:e.heartbeat=t,"undefined"==typeof Promise&&!function(){function t(e){function n(e,t){o.state="pending",o[e].length?setTimeout(function(){n(e,o.value=o[e].shift().call(r,t))},0):o.state=e}var r=this,o=r.then=function(){return t.prototype.then.apply(r,arguments)};return o.fulfilled=[],o.rejected=[],o.fulfill=function(e){n("fulfilled",e)},o.reject=function(e){n("rejected",e)},e.call(r,o.fulfill,o.reject),r}t.prototype={constructor:t,then:function(e,t){return e&&this.then.fulfilled.push(e),t&&this.then.rejected.push(t),"fulfilled"===this.then.state&&this.then.fulfill(this.then.value),this},"catch":function(e){return e&&this.then.rejected.push(e),this}},t.all=function(){function e(e,t,n){e.then(function o(n){return e.then.fulfilled.length>1?e.then(o):--r||t(n),n},function(e){n(e)})}var n=Array.prototype.slice.call(arguments),r=n.length;return new t(function(t,r){for(;n.length;)e(n.shift(),t,r)})},e.Promise=t}(),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments,1),r=function(){},o=function(){return t.apply(this instanceof r&&e?this:e,n.concat(Array.prototype.slice.call(arguments,0)))};return r.prototype=o.prototype=t.prototype,o}),Array.prototype.forEach||(Array.prototype.forEach=function(t,n){for(var r=this,o=0,i=r.length;i>o;++o)t.call(n||e,r[o],o,r)}),"undefined"==typeof e.JSON&&!function(){function e(e){this.line=1,this.col=1,this._tokLen=0,this._str=e}function t(e){this.lex=e}function n(e,t,n){return"undefined"==typeof n?void delete e[t]:void(e[t]=n)}function r(e,t,o){var a,s,u=e[t];if("Array"===i.call(u).slice(8,-1))for(a=0,s=u.length;s>a;a++)n(u,a,r(u,a,o));else if("object"==typeof u)for(a in u)l.call(u,a)&&n(u,a,r(u,a,o));return o.call(e,t,u)}function o(e,t){return e=String(e),e.length>=t?e:new Array(t-e.length+1).join("0")+e}var i=Object.prototype.toString,l=Object.prototype.hasOwnProperty,a="{",s="}",u=":",c="[",f="]",h=",",g={PUNCTUATOR:1,STRING:2,NUMBER:3,BOOLEAN:4,NULL:5},p={"{":1,"}":1,"[":1,"]":1,",":1,":":1,'"':2,t:4,f:4,n:5},d={b:"\b",f:"\f",n:"\n",r:"\r",t:"	",'"':'"',"\\":"\\","/":"/"},y=/^(?:[{}:,\[\]]|true|false|null|"(?:[^"\\\u0000-\u001F]|\\["\\\/bfnrt]|\\u[0-9A-F]{4})*"|-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)/,v=/^[\t ]+/,m=/^\r?\n/;e.prototype={getNextToken:function(){var e,t,n=this._str;if(this.col+=this._tokLen,!n.length)return"END";if(e=y.exec(n))t=p[e[0].charAt(0)]||g.NUMBER;else{if(e=v.exec(n))return this._tokLen=e[0].length,this._str=n.slice(this._tokLen),this.getNextToken();if(e=m.exec(n))return this._tokLen=0,this._str=n.slice(e[0].length),this.line++,this.col=1,this.getNextToken();this.error("Invalid token")}return this._tokLen=e[0].length,this._str=n.slice(this._tokLen),{type:t,value:e[0]}},error:function(e,t,n){var r=new SyntaxError(e);throw r.line=t||this.line,r.col=n||this.col,r}},t.prototype={parse:function(){var e=this.lex,t=this.getValue();return"END"!==e.getNextToken()&&e.error("Illegal token"),t},getObject:function(){for(var e,t,n,r,o,i={},l=this.lex,a=!1;;){if(e=l.getNextToken(),t=e.value,t===s)return i;a?t===h?(r=l.line,o=l.col-1,e=l.getNextToken(),t=e.value,t===s&&l.error("Invalid trailing comma",r,o)):l.error("Illegal token where expect comma or right curly bracket"):t===h&&l.error("Invalid leading comma"),e.type!=g.STRING&&l.error("Illegal token where expect string property name"),n=this.getString(t),e=l.getNextToken(),t=e.value,t!=u&&l.error("Illegal token where expect colon"),i[n]=this.getValue(),a=!0}},getArray:function(){for(var e,t,n,r,o=[],i=this.lex,l=!1;;){if(e=i.getNextToken(),t=e.value,t===f)return o;l?t===h?(n=i.line,r=i.col-1,e=i.getNextToken(),t=e.value,t===f&&i.error("Invalid trailing comma",n,r)):i.error("Illegal token where expect comma or right square bracket"):t===h&&i.error("Invalid leading comma"),o.push(this.getValue(e)),l=!0}},getString:function(e){return e.slice(1,-1).replace(/\\u?([0-9A-F]{4}|["\\\/bfnrt])/g,function(e,t){return d[t]||String.fromCharCode(parseInt(t,16))})},getValue:function(e){var t=this.lex,n=e||t.getNextToken(),r=n.value;switch(n.type){case g.PUNCTUATOR:if(r===a)return this.getObject();if(r===c)return this.getArray();t.error("Illegal punctoator");break;case g.STRING:return this.getString(r);case g.NUMBER:return Number(r);case g.BOOLEAN:return"true"===r;case g.NULL:return null;default:t.error("Invalid value")}}},Window.prototype.JSON={parse:function(n,o){var i=new t(new e(n)).parse();return"function"==typeof o?r({"":i},"",o):i},stringify:function(){var e,t,n,r,a,s,u=arguments[0],c="function"==typeof arguments[1]?arguments[1]:null,f=arguments[2]||"",h=f?" ":"",g=f?"\n":"",p=i.call(u).slice(8,-1);if(null===u||"Boolean"===p||"Number"===p)return u;if("Array"===p){for(e=[],a=u.length,r=0,s;a>r;++r)s=c?c(r,u[r]):u[r],s=this.stringify(s,c,f),(void 0===s||null===s)&&(s="null"),e.push(s);return"["+g+e.join(","+g).replace(/^/gm,f)+g+"]"}if("Date"===p)return'"'+u.getUTCFullYear()+"-"+o(u.getUTCMonth()+1,2)+"-"+o(u.getUTCDate(),2)+"T"+o(u.getUTCHours(),2)+":"+o(u.getUTCMinutes(),2)+":"+o(u.getUTCSeconds(),2)+"."+o(u.getUTCMilliseconds(),3)+'Z"';if("String"===p)return'"'+u.replace(/"/g,'\\"')+'"';if("object"==typeof u){e=[],n=!1;for(t in u)l.call(u,t)&&(s=c?c(t,u[t]):u[t],s=this.stringify(s,c,f),void 0!==s&&(n=!0,e.push('"'+t+'":'+h+s)));return n?"{"+g+e.join(","+g).replace(/^/gm,f)+g+"}":"{}"}}}}(),Array.prototype.filter||(Array.prototype.filter=function(t,n){for(var r,o=this,i=[],l=0,a=o.length;a>l;++l)r=o[l],t.call(n||e,r,l,o)&&i.push(r);return i})}(window);